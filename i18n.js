// C:\Users\SMC\Documents\GitHub\procurement-erp-system\frontend\i18n.js
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

// English translations
const enTranslations = {
  welcome: "Welcome",
  signup: "Sign Up",
  login: "Login",
  email: "Email Address",
  password: "Password",
  fullName: "Full Name",
  companyName: "Company Name",
  phone: "Phone Number",
  country: "Country",
  accessCode: "Access Code",
  department: "Department",
  terms: "I agree to the Terms & Conditions",
  privacy: "Privacy Policy",
  support: "Support",
  help: "Help",
  language: "Language",
  submit: "Submit",
  loading: "Loading...",
  error: "Error",
  success: "Success",
  confirmPassword: "Confirm Password",
  weak: "Weak",
  fair: "Fair",
  good: "Good",
  strong: "Strong",
  veryWeak: "Very Weak",
  passwordStrength: "Password Strength",
  next: "Next",
  back: "Back",
  completeRegistration: "Complete Registration",
  alreadyHaveAccount: "Already have an account?",
  signInHere: "Sign in here",
  supplierRegistration: "Supplier Registration",
  staffRegistration: "Staff Registration",
  basicInfo: "Basic Information",
  companyDetails: "Company Details",
  staffDetails: "Staff Details",
  complete: "Complete",  
  learnMore: "Learn More About Our Company",
  aboutCompany: "About KUN Real Estate",
  aboutDescription1: "We are a leading developer and investment group in Saudi Arabia, managing large-scale hospitality, residential, and mixed-use projects.",
  aboutDescription2: "Our Procurement & Contracts Department connects with qualified suppliers and contractors who share our commitment to quality, safety, and timely delivery.",
  welcomeBack: "Welcome Back",
  loginDescription: "Sign in to access supplier registration, RFQs, and contract management",
  forgotPassword: "Forgot password?",
  rememberMe: "Remember me for 30 days",
  securityVerification: "Security Verification",
  securityDescription: "This helps prevent automated attacks",
  signingIn: "Signing In...",
  secureLogin: "Secure Login",
  needAccount: "Need an account?",
  registerAsSupplier: "Register as Supplier",
  registerAsStaff: "Register as Staff",
  needHelp: "Need help? Contact Support",
  department: "Procurement & Contracts Department",  
  procurementSystem: "Procurement System",
  supplierStaffRegistration: "Supplier & Staff Registration",
  gatewayQuote: "Your gateway to partnering with KUN Real Estate.",
  whoCanRegister: "Who Can Register?",
  vendorDescription: "**Vendors/Suppliers:** Register your company to participate in our Request for Quotation (RFQ) processes and manage contracts.",
  staffDescription: "**Staff:** Use your internal access code to create an account and join the Procurement & Contracts department.",
  createAccount: "Create Your ProcureTrack Account",
  step1Description: "Step {{step}}: {{description}}",
  basicInformationDesc: "Enter your basic information",
  companyDetailsDesc: "Enter company details",
  staffInfoDesc: "Enter staff information",
  fullNameRepresentative: "Full Name / Company Representative",
  selectDepartment: "Select Your Department",
  chooseDepartment: "Choose your department",
  progressStep: "Step {{current}} of {{total}}",
  buildingExcellence: "Building excellence through trusted partnerships.",
  accountant: "Accountant",
  procurement: "Procurement",
  secretary: "Secretary",
  logistics: "Logistics",
  executive: "Executive",
  step: "Step",
  continueStep2: "Continue to Step 2",
  creatingAccount: "Creating Account...",
  securityCheck: "Loading security verification...",
  stepXOfY: "Step {{current}} of {{total}}",
  stepDescription: "Step {{stepNumber}}: {{description}}",
  enterBasicInfo: "Enter your basic information",
  enterCompanyDetails: "Enter company details",
  enterStaffInfo: "Enter staff information",
  johnSmithPlaceholder: "John Smith or Company Name",
  emailPlaceholder: "you@example.com",
  passwordPlaceholder: "••••••••",
  companyNamePlaceholder: "Your Company Name",
  phonePlaceholder: "+1 (555) 123-4567",
  countryPlaceholder: "Your Country",
  accessCodePlaceholder: "Enter staff access code",
  chooseDepartment: "Choose your department",
  selectYourDepartment: "Select Your Department",
  agreeTerms: "I agree to the",
  and: "and",
  continueToStep2: "Continue to Step 2",
  backButton: "Back",
  creatingAccount: "Creating Account...",
  completeRegistration: "Complete Registration",
  accountant: "Accountant",
  procurement: "Procurement", 
  secretary: "Secretary",
  logistics: "Logistics",
  executive: "Executive",  
  nameRequired: "Name is required",
  emailRequired: "Email is required",
  emailInvalid: "Email is invalid",
  passwordRequired: "Password is required",
  passwordTooShort: "Password must be at least 8 characters",
  passwordsDontMatch: "Passwords do not match",
  agreeToTermsRequired: "You must agree to the terms and conditions",
  companyNameRequired: "Company name is required",
  phoneRequired: "Phone number is required",
  accessCodeRequired: "Access code is required",
  departmentRequired: "Please select your department",
  copyright: "© 2025 KUN Real Estate – Procurement Division. All rights reserved.",
  termsConditions: "Terms & Conditions",
  privacyPolicy: "Privacy Policy",
  supportContact: "Support Contact",
  cookiePolicy: "Cookie Policy",
  emailLabel: "Email:",
  phoneLabel: "Phone:",
  emailValue: "procurement@kunrealestate.com",
  phoneValue: "+966 11 123 4567",
  or: "or",


  // New dashboard translations
  executiveDashboard: "Executive Dashboard",
  dashboardSubtitle: "Procurement performance and KPIs",
  loadingDashboard: "Loading executive dashboard...",
  loadingDashboardFull: "Loading Executive Dashboard...",
  connectingDatabase: "Connecting to procurement database",
  dashboardError: "Error loading dashboard",
  retry: "Retry",
  retryConnection: "Retry Connection",
  unableToLoadDashboard: "Unable to load dashboard",
  checkBackendConnection: "Please check your backend connection",
  dashboardFetchError: "Failed to fetch dashboard data: {status}",
  
  // Time ranges
  thisMonth: "This Month",
  thisQuarter: "This Quarter",
  thisYear: "This Year",
  
  // Data source indicators
  liveData: "Live Data",
  apiConnected: "API Connected",
  sampleData: "Sample Data",
  loadingAnalytics: "Loading Analytics...",
  refreshAllData: "Refresh all data",
  
  // Financial metrics
  totalSpend: "Total Spend",
  cumulativeContractValue: "Cumulative contract value",
  budgetUtilization: "Budget Utilization",
  basedOnEstimatedBudgets: "Based on estimated project budgets",
  costSavings: "Cost Savings",
  throughNegotiation: "Through negotiation and optimization",
  activeProjects: "Active Projects",
  projectsInProgress: "projects in progress",
  
  // Vendor metrics
  totalVendors: "Total Vendors",
  registeredInSystem: "Registered in the system",
  approvedVendors: "Approved Vendors",
  vendorsNeedingReview: "Vendors Needing Review",
  pendingQualificationReview: "Pending qualification review",
  pendingApprovals: "Pending Approvals",
  awaitingAuthorization: "Awaiting authorization",
  
  // Project metrics
  projectPerformance: "Project Performance",
  currentlyInExecution: "Currently in execution phase",
  noActiveProjects: "No Active Projects",
  addProjectsToSeeProgress: "Add projects to see progress",
  teamMembers: "Team Members",
  activeProcurementTeam: "Active procurement team",
  
  // Risk & compliance
  riskComplianceAlerts: "Risk & Compliance Alerts",
  activeAlerts: "Active Alerts",
  allClear: "All Clear",
  noActiveAlerts: "No active alerts",
  allSystemsCompliant: "All systems are compliant",
  
  // Quick actions
  quickActions: "Quick Actions",
  viewReports: "View Reports",
  vendorAnalysis: "Vendor Analysis",
  financialSummary: "Financial Summary",
  performanceReview: "Performance Review",
  
  // Database connection
  databaseConnectionIssue: "Database Connection Issue",
  showingSampleData: "Showing sample data. Real-time data will resume when database connection is restored.",
  
  // Layout translations
  dashboard: "Dashboard",
  loading: "Loading...",
  executiveDashboard: "Executive Dashboard",
  executiveOverview: "Executive Overview",
  managerDashboard: "Manager Dashboard",
  procurementManagerDashboard: "Procurement Manager Dashboard",
  officerDashboard: "Officer Dashboard",
  procurementOfficerDashboard: "Procurement Officer Dashboard",
  vendorPortal: "Vendor Portal",
  vendorDashboard: "Vendor Dashboard",
  kunRealEstate: "KUN Real Estate",
  procurementSystem: "Procurement System",
  logout: "Logout",
  signOut: "Sign Out",
  refreshDashboard: "Refresh Dashboard",
  procurementManager: "Procurement Manager",
  accountSettings: "Account Settings",
  
  // Navigation items (add these based on your navigation structure)
  overview: "Overview",
  vendors: "Vendors",
  contracts: "Contracts",
  projects: "Projects",
  reports: "Reports",
  settings: "Settings",
  profile: "Profile",
  
  // KPI translations
  procurementEfficiency: "Procurement Efficiency",
  processOptimizationScore: "Process optimization score",
  costSavingsRate: "Cost Savings Rate",
  againstTotalSpend: "Against total spend",
  contractCompliance: "Contract Compliance",
  adherenceToTerms: "Adherence to terms",
  vendorSatisfaction: "Vendor Satisfaction",
  partnerFeedbackScore: "Partner feedback score",
  
  // Alert types
  critical: "Critical",
  warning: "Warning",
  medium: "Medium",

  // Navigation items
  dashboard: "Dashboard",
  financialAnalytics: "Financial Analytics",
  vendorPerformance: "Vendor Performance",
  projectPortfolio: "Project Portfolio",
  complianceDashboard: "Compliance Dashboard",
  approvals: "Approvals",
  informationRequests: "Information Requests",
  userManagement: "User Management",
  reports: "Reports",
  systemSettings: "System Settings",
  accountApprovals: "Account Approvals",
  workflowBuilder: "Workflow Builder",
  teamOverview: "Team Overview",
  approvalQueue: "Approval Queue",
  materialSubmittals: "Material Submittals",
  shopDrawings: "Shop Drawings",
  deliveries: "Deliveries",
  budgetControl: "Budget Control",
  supplierPerformance: "Supplier Performance",
  taskAssignment: "Task Assignment",
  vendorManagement: "Vendor Management",
  rfqs: "RFQs",
  pos: "POs",
  prs: "PRs",
  contracts: "Contracts",
  invoice: "Invoice",
  ipcs: "IPCs",
  performanceMetrics: "Performance Metrics",
  myTasks: "My Tasks",
  rfos: "RFOs",
  costControl: "Cost Control",
  submitProposal: "Submit Proposal",
  trackSubmissions: "Track Submissions",
  myProfile: "My Profile",
  
  // Role names
  executive: "Executive",
  procurementManager: "Procurement Manager",
  procurementOfficer: "Procurement Officer",
  vendor: "Vendor"
};

// Arabic translations
const arTranslations = {
  welcome: "مرحباً",
  signup: "التسجيل",
  login: "تسجيل الدخول",
  email: "البريد الإلكتروني",
  password: "كلمة المرور",
  fullName: "الاسم الكامل",
  companyName: "اسم الشركة",
  phone: "رقم الهاتف",
  country: "البلد",
  accessCode: "رمز الدخول",
  department: "القسم",
  terms: "أوافق على الشروط والأحكام",
  privacy: "سياسة الخصوصية",
  support: "الدعم",
  help: "مساعدة",
  language: "اللغة",
  submit: "إرسال",
  loading: "جاري التحميل...",
  error: "خطأ",
  success: "نجاح",
  confirmPassword: "تأكيد كلمة المرور",
  weak: "ضعيفة",
  fair: "متوسطة",
  good: "جيدة",
  strong: "قوية",
  veryWeak: "ضعيفة جداً",
  passwordStrength: "قوة كلمة المرور",
  next: "التالي",
  back: "السابق",
  completeRegistration: "إتمام التسجيل",
  alreadyHaveAccount: "هل لديك حساب بالفعل؟",
  signInHere: "سجل الدخول هنا",
  supplierRegistration: "تسجيل الموردين",
  staffRegistration: "تسجيل الموظفين",
  basicInfo: "المعلومات الأساسية",
  companyDetails: "تفاصيل الشركة",
  staffDetails: "تفاصيل الموظف",
  complete: "إكمال",
  learnMore: "اعرف المزيد عن شركتنا",
  aboutCompany: "حول شركة كون العقارية",
  aboutDescription1: "نحن مجموعة رائدة في التطوير والاستثمار في المملكة العربية السعودية، ندير مشاريع ضخمة في الضيافة والسكن والمشاريع المختلطة.",
  aboutDescription2: "يقوم قسم المشتريات والعقود لدينا بالتواصل مع الموردين والمقاولين المؤهلين الذين يشاركوننا التزامنا بالجودة والسلامة والتسليم في الوقت المحدد.",
  welcomeBack: "مرحباً بعودتك",
  loginDescription: "سجل الدخول للوصول إلى تسجيل الموردين وطلبات العروض وإدارة العقود",
  forgotPassword: "نسيت كلمة المرور؟",
  rememberMe: "تذكرني لمدة 30 يومًا",
  securityVerification: "التحقق الأمني",
  securityDescription: "هذا يساعد في منع الهجمات الآلية",
  signingIn: "جاري تسجيل الدخول...",
  secureLogin: "تسجيل دخول آمن",
  needAccount: "هل تحتاج إلى حساب؟",
  registerAsSupplier: "سجل كمورد",
  registerAsStaff: "سجل كموظف",
  needHelp: "هل تحتاج إلى مساعدة؟ اتصل بالدعم",
  department: "قسم المشتريات والعقود",  
  procurementSystem: "نظام المشتريات",
  supplierStaffRegistration: "تسجيل الموردين والموظفين",
  gatewayQuote: "بوابتك للشراكة مع شركة كون العقارية.",
  whoCanRegister: "من يمكنه التسجيل؟",
  vendorDescription: "**البائعون/الموردون:** سجل شركتك للمشاركة في عمليات طلب العروض وإدارة العقود.",
  staffDescription: "**الموظفون:** استخدم رمز الدخول الداخلي الخاص بك لإنشاء حساب والانضمام إلى قسم المشتريات والعقود.",
  createAccount: "أنشئ حسابك في ProcureTrack",
  step1Description: "الخطوة {{step}}: {{description}}",
  basicInformationDesc: "أدخل معلوماتك الأساسية",
  companyDetailsDesc: "أدخل تفاصيل الشركة",
  staffInfoDesc: "أدخل معلومات الموظف",
  fullNameRepresentative: "الاسم الكامل / ممثل الشركة",
  selectDepartment: "اختر قسمك",
  chooseDepartment: "اختر قسمك",
  progressStep: "الخطوة {{current}} من {{total}}",
  buildingExcellence: "بناء التميز من خلال الشراكات الموثوقة.",
  accountant: "محاسب",
  procurement: "المشتريات",
  secretary: "سكرتير",
  logistics: "اللوجستيات",
  executive: "تنفيذي",
  step: "خطوة",
  continueStep2: "المتابعة إلى الخطوة 2",
  creatingAccount: "جاري إنشاء الحساب...",
  securityCheck: "جاري تحميل التحقق الأمني...",
  stepXOfY: "الخطوة {{current}} من {{total}}",
  stepDescription: "الخطوة {{stepNumber}}: {{description}}",
  enterBasicInfo: "أدخل معلوماتك الأساسية",
  enterCompanyDetails: "أدخل تفاصيل الشركة",
  enterStaffInfo: "أدخل معلومات الموظف",
  johnSmithPlaceholder: "جون سميث أو اسم الشركة",
  emailPlaceholder: "you@example.com",
  passwordPlaceholder: "••••••••",
  companyNamePlaceholder: "اسم شركتك",
  phonePlaceholder: "+1 (555) 123-4567",
  countryPlaceholder: "بلدك",
  accessCodePlaceholder: "أدخل رمز الدخول للموظفين",
  chooseDepartment: "اختر قسمك",
  selectYourDepartment: "اختر قسمك",
  agreeTerms: "أوافق على",
  and: "و",
  continueToStep2: "المتابعة إلى الخطوة 2",
  backButton: "السابق",
  creatingAccount: "جاري إنشاء الحساب...",
  completeRegistration: "إتمام التسجيل",  
  accountant: "محاسب",
  procurement: "المشتريات",
  secretary: "سكرتير", 
  logistics: "اللوجستيات",
  executive: "تنفيذي",  
  nameRequired: "الاسم مطلوب",
  emailRequired: "البريد الإلكتروني مطلوب",
  emailInvalid: "البريد الإلكتروني غير صالح",
  passwordRequired: "كلمة المرور مطلوبة",
  passwordTooShort: "يجب أن تكون كلمة المرور 8 أحرف على الأقل",
  passwordsDontMatch: "كلمات المرور غير متطابقة",
  agreeToTermsRequired: "يجب أن توافق على الشروط والأحكام",
  companyNameRequired: "اسم الشركة مطلوب",
  phoneRequired: "رقم الهاتف مطلوب",
  accessCodeRequired: "رمز الدخول مطلوب",
  departmentRequired: "يرجى اختيار قسمك",
  copyright: "© 2025 شركة كون العقارية – قسم المشتريات. جميع الحقوق محفوظة.",
  termsConditions: "الشروط والأحكام",
  privacyPolicy: "سياسة الخصوصية",
  supportContact: "اتصال الدعم",
  cookiePolicy: "سياسة الكوكيز",
  emailLabel: "البريد الإلكتروني:",
  phoneLabel: "الهاتف:",
  emailValue: "procurement@kunrealestate.com",
  phoneValue: "+966 11 123 4567",
  or: "أو",


  // New dashboard translations in Arabic
  executiveDashboard: "لوحة التحكم التنفيذية",
  dashboardSubtitle: "أداء المشتريات والمؤشرات الرئيسية",
  loadingDashboard: "جاري تحميل لوحة التحكم التنفيذية...",
  loadingDashboardFull: "جاري تحميل لوحة التحكم التنفيذية...",
  connectingDatabase: "جاري الاتصال بقاعدة بيانات المشتريات",
  dashboardError: "خطأ في تحميل لوحة التحكم",
  retry: "إعادة المحاولة",
  retryConnection: "إعادة الاتصال",
  unableToLoadDashboard: "تعذر تحميل لوحة التحكم",
  checkBackendConnection: "يرجى التحقق من اتصال الخادم الخلفي",
  dashboardFetchError: "فشل في جلب بيانات لوحة التحكم: {status}",
  
  // Time ranges
  thisMonth: "هذا الشهر",
  thisQuarter: "هذا الربع",
  thisYear: "هذا العام",
  
  // Data source indicators
  liveData: "بيانات حية",
  apiConnected: "متصل بالواجهة البرمجية",
  sampleData: "بيانات تجريبية",
  loadingAnalytics: "جاري تحميل التحليلات...",
  refreshAllData: "تحديث جميع البيانات",
  
  // Financial metrics
  totalSpend: "إجمالي الإنفاق",
  cumulativeContractValue: "القيمة التراكمية للعقود",
  budgetUtilization: "استخدام الميزانية",
  basedOnEstimatedBudgets: "بناءً على ميزانيات المشاريع المقدرة",
  costSavings: "توفير التكاليف",
  throughNegotiation: "من خلال التفاوض والتحسين",
  activeProjects: "المشاريع النشطة",
  projectsInProgress: "مشروع قيد التنفيذ",
  
  // Vendor metrics
  totalVendors: "إجمالي الموردين",
  registeredInSystem: "مسجلين في النظام",
  approvedVendors: "الموردون المعتمدون",
  vendorsNeedingReview: "الموردون الذين يحتاجون مراجعة",
  pendingQualificationReview: "في انتظار مراجعة التأهيل",
  pendingApprovals: "الموافقات المعلقة",
  awaitingAuthorization: "في انتظار التصريح",
  
  // Project metrics
  projectPerformance: "أداء المشروع",
  currentlyInExecution: "حالياً في مرحلة التنفيذ",
  noActiveProjects: "لا توجد مشاريع نشطة",
  addProjectsToSeeProgress: "أضف مشاريع لرؤية التقدم",
  teamMembers: "أعضاء الفريق",
  activeProcurementTeam: "فريق المشتريات النشط",
  
  // Risk & compliance
  riskComplianceAlerts: "تنبيهات المخاطر والامتثال",
  activeAlerts: "تنبيهات نشطة",
  allClear: "جميع الأنظمة تعمل",
  noActiveAlerts: "لا توجد تنبيهات نشطة",
  allSystemsCompliant: "جميع الأنظمة متوافقة",
  
  // Quick actions
  quickActions: "إجراءات سريعة",
  viewReports: "عرض التقارير",
  vendorAnalysis: "تحليل الموردين",
  financialSummary: "ملخص مالي",
  performanceReview: "مراجعة الأداء",
  
  // Database connection
  databaseConnectionIssue: "مشكلة في اتصال قاعدة البيانات",
  showingSampleData: "عرض بيانات تجريبية. ستستأنف البيانات الفعلية عند استعادة اتصال قاعدة البيانات.",
  
  // Layout translations in Arabic
  dashboard: "لوحة التحكم",
  loading: "جاري التحميل...",
  executiveDashboard: "لوحة التحكم التنفيذية",
  executiveOverview: "نظرة عامة تنفيذية",
  managerDashboard: "لوحة تحكم المدير",
  procurementManagerDashboard: "لوحة تحكم مدير المشتريات",
  officerDashboard: "لوحة تحكم الموظف",
  procurementOfficerDashboard: "لوحة تحكم موظف المشتريات",
  vendorPortal: "بوابة الموردين",
  vendorDashboard: "لوحة تحكم المورد",
  kunRealEstate: "شركة كون العقارية",
  procurementSystem: "نظام المشتريات",
  logout: "تسجيل الخروج",
  signOut: "تسجيل الخروج",
  refreshDashboard: "تحديث لوحة التحكم",
  procurementManager: "مدير المشتريات",
  accountSettings: "إعدادات الحساب",
  
  // Navigation items
  overview: "نظرة عامة",
  vendors: "الموردون",
  contracts: "العقود",
  projects: "المشاريع",
  reports: "التقارير",
  settings: "الإعدادات",
  profile: "الملف الشخصي",
  
  // KPI translations
  procurementEfficiency: "كفاءة المشتريات",
  processOptimizationScore: "نتيجة تحسين العملية",
  costSavingsRate: "معدل توفير التكاليف",
  againstTotalSpend: "مقابل إجمالي الإنفاق",
  contractCompliance: "امتثال العقد",
  adherenceToTerms: "الالتزام بالشروط",
  vendorSatisfaction: "رضا الموردين",
  partnerFeedbackScore: "نتيجة ملاحظات الشريك",
  
  // Alert types
  critical: "حرج",
  warning: "تحذير",
  medium: "متوسط",

  // Navigation items in Arabic
  dashboard: "لوحة التحكم",
  financialAnalytics: "التحليلات المالية",
  vendorPerformance: "أداء الموردين",
  projectPortfolio: "محفظة المشاريع",
  complianceDashboard: "لوحة الامتثال",
  approvals: "الموافقات",
  informationRequests: "طلبات المعلومات",
  userManagement: "إدارة المستخدمين",
  reports: "التقارير",
  systemSettings: "إعدادات النظام",
  accountApprovals: "موافقات الحسابات",
  workflowBuilder: "منشئ سير العمل",
  teamOverview: "نظرة عامة على الفريق",
  approvalQueue: "قائمة انتظار الموافقات",
  materialSubmittals: "تقديمات المواد",
  shopDrawings: "رسومات المحل",
  deliveries: "التسليمات",
  budgetControl: "مراقبة الميزانية",
  supplierPerformance: "أداء الموردين",
  taskAssignment: "تعيين المهام",
  vendorManagement: "إدارة الموردين",
  rfqs: "طلبات العروض",
  pos: "أوامر الشراء",
  prs: "طلبات الشراء",
  contracts: "العقود",
  invoice: "الفواتير",
  ipcs: "شهادات الدفع المؤقتة",
  performanceMetrics: "مقاييس الأداء",
  myTasks: "مهامي",
  rfos: "عروض الطلبات",
  costControl: "مراقبة التكاليف",
  submitProposal: "تقديم مقترح",
  trackSubmissions: "تتبع التقديمات",
  myProfile: "ملفي الشخصي",
  
  // Role names in Arabic
  executive: "تنفيذي",
  procurementManager: "مدير المشتريات",
  procurementOfficer: "موظف المشتريات",
  vendor: "مورد",
};

// Add a function to set HTML direction
const updateDocumentDirection = (lng) => {
  if (typeof document !== 'undefined') {
    document.documentElement.dir = lng === 'ar' ? 'rtl' : 'ltr';
    document.documentElement.lang = lng;
  }
};

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources: {
      en: { translation: enTranslations },
      ar: { translation: arTranslations }
    },
    fallbackLng: 'en',
    interpolation: {
      escapeValue: false,
    },
    detection: {
      order: ['localStorage', 'navigator'],
      lookupLocalStorage: 'preferred-language', // Changed to match your code
      caches: ['localStorage'],
    },
  });

// Listen for language changes
i18n.on('languageChanged', (lng) => {
  updateDocumentDirection(lng);
  localStorage.setItem('preferred-language', lng); // Sync with your preference
});

// Set initial direction
if (typeof window !== 'undefined') {
  const savedLang = localStorage.getItem('preferred-language') || 'en';
  updateDocumentDirection(savedLang);
}

export default i18n;